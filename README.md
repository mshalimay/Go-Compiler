# Golite-Compiler
This is a compiler for a subset of the `Go` language, which we call `Golite`. The compiler is developed in the `Go` language version 1.19.

More details on implementation can be found in `report.pdf`.

All the relevant scripts uses heavily the [visitor's pattern]([url](https://en.wikipedia.org/wiki/Visitor_pattern)). To understand the codebase, I recommend refering to the `grammars/golite-compiler` for the general structure of the language. Then traversing the AST functions (such as the `String()` function) starting from `Program`, then `Declarations`, `Functions`, `TypeDecls`, then all `Statement` nodes then all `Expression` nodes (see the `ast/ast.go` for a list of each type of node).

## Usage
Below are the steps for building and running the compiler in linux machines 

1) clone the repository using 
`git clone https://github.com/mshalimay/golite-compiler`

3) Navigate to the directory where the repo was downloaded and execute `go mod tidy` to download the required dependencies


4) Building the *lexer* and *parser* using ANTLR

- Note: the repo already contains the files generated by ANTLR. 
- To reproduce the files using ANTLR autogeneration, navigate to `grammars` and execute the `generate.sh` script running: `source generate.sh`
- This will override/create new files for the parser and lexer based on the grammar rules defined in `GoliteLexer.g4` and `GoLliteParser.g4`

5) Building the compiler

- Navigate to the `golite` directory and execute `go build golite.go`
- This will build an executable called `golite`

6) Running the compiler

- To see the usage for the compiler, run: `./golite -h`

- The executable from step 5 takes the following inputs:
  - `--lex`: to run the compiler in lexer mode. This will print the program's tokens recognized by the lexer, but will not parse it.
  - `--ast`: to print the generated AST. The AST will be printed along with any semantic errors if there is any.
  - `--llvm`: to generate a `.ll` file with the translation of the source code to LLVM. Optionally can define a `target-triple` as a second argument.
  - `-s`: to generate the `s` file with the translation of source code to ARM. 
  - `-e`: to compile and execute the ARM file generated with `s`. Optionally, can provide a name to the executable with the `o` flag. Defaults to `a.out`
  - `-o`: provide a name to the executable created by the `-e` flag.
  - `path_to_file`: the full path to a `.golite` file containing a `golite` script.
  - `target-triple`: sets the target tripe for the `ll` file. Defaults to `x86_64-linux-gnu`

- To run the compiler in `lexer` mode, **from the `golite` directory**: `./golite -lex ../benchmarks/filename.golite`

- To parse the program, run `./golite ../benchmarks/filename.golite`. This will print the sintactic errors, but not the ast.

- To generate the `ll` file, run `./golite -llvm ../benchmarks/filename.golite`. This will create the file `../benchmarks/filename.ll` with the translation of the source code to LLVM. 
- To set a specific target triple, add it's string as the last argument, as in: `./golite -llvm ../benchmarks/filename.golite arm64-apple-macosx13.0.0` 

- To print the ast and parse the program, run `./golite --ast ../benchmarks/filename.golite`. This will print the ast and sintactic errors.

- obs: above assumes you are running from the `golite` directory and the original structure of the repo is mantained. You can also provide an absolute path such as `~/proj-mashalimay/benchmarks/bad1.golite`

- To generate the `.s` file, run `./golite -s ../benchmarks/filename.golite`
  - This will create the file `../benchmarks/filename.s` with the translation of the source code to ARM assembly. 

- To generate the `.s` file and compile into an executable called `myExecutable`, run: 
  - `./golite -s -e -o myExecutable ../benchmarks/filename.golite`
  - This will create the file `../benchmarks/filename.s` with the translation of the source code to ARM assembly.
  - This will create the file `../benchmarks/myExecutable.out`
